<!DOCTYPE html>
<!--
  ██╗    ██╗    ██╗ █████╗ ███████╗    ███████╗██╗  ██╗██████╗ ███████╗ ██████╗████████╗██╗███╗   ██╗ ██████╗     ██╗   ██╗ ██████╗ ██╗   ██╗    ██╗
  ██║    ██║    ██║██╔══██╗██╔════╝    ██╔════╝╚██╗██╔╝██╔══██╗██╔════╝██╔════╝╚══██╔══╝██║████╗  ██║██╔════╝     ╚██╗ ██╔╝██╔═══██╗██║   ██║    ██║
  ██║    ██║ █╗ ██║███████║███████╗    █████╗   ╚███╔╝ ██████╔╝█████╗  ██║        ██║   ██║██╔██╗ ██║██║  ███╗     ╚████╔╝ ██║   ██║██║   ██║    ██║
  ██║    ██║███╗██║██╔══██║╚════██║    ██╔══╝   ██╔██╗ ██╔═══╝ ██╔══╝  ██║        ██║   ██║██║╚██╗██║██║   ██║      ╚██╔╝  ██║   ██║██║   ██║    ╚═╝
  ██║    ╚███╔███╔╝██║  ██║███████║    ███████╗██╔╝ ██╗██║     ███████╗╚██████╗   ██║   ██║██║ ╚████║╚██████╔╝       ██║   ╚██████╔╝╚██████╔╝    ██╗
  ╚═╝     ╚══╝╚══╝ ╚═╝  ╚═╝╚══════╝    ╚══════╝╚═╝  ╚═╝╚═╝     ╚══════╝ ╚═════╝   ╚═╝   ╚═╝╚═╝  ╚═══╝ ╚═════╝        ╚═╝    ╚═════╝  ╚═════╝     ╚═╝
 -->
<html lang="en-us">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-P8JYGFF61H"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-P8JYGFF61H');
    </script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="theme" content="hugo-academic"/>
    <meta name="generator" content="Hugo 0.49"/>
    <meta name="author" content="Aman Shrivastava"/>
    <meta name="description" content="">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.0/css/academicons.min.css" integrity="sha512-GGGNUPDhnG8LEAEDsjqYIQns+Gu8RBs4j5XGlxl7UfRaZBhCCm5jenJkeJL8uPuOXGqgl8/H1gjlWQDRjd3cUQ==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather%7CRoboto+Mono">
    <link rel="stylesheet" href="/css/hugo-academic.css">
    <link rel="stylesheet" href="/css/highlight.min.css">
    <link rel="icon" type="image/jpeg" href="../img/ticon.jpg">
    <link rel="apple-touch-icon" type="image/png" href="../img/apple-touch-icon.jpg">
    <link rel="canonical" href="https://imashrivastava.github.io/team">

    <title>Team | Animal Welfare Platform</title>
    <style>
        h2 {
            color: #000000;
            border-bottom: 1px solid #000000;
            padding-bottom: 0.5rem;
            margin-top: 4rem;
        }
        .pub-card {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(2px);
            -webkit-backdrop-filter: blur(2px);
            border-radius: 12px;
            padding: 1rem 1rem 0.5rem;
            margin-bottom: 12px;
            box-shadow: 0 2px 24px rgba(0,0,0,0.6);
            cursor: pointer;
            transition: all 0.25s ease-in-out;
            position: relative;
            display: flex;
            flex-wrap: wrap;
            align-items: flex-start;
            gap: 12px;
            border: 1px solid rgba(255,255,255,0.05);
            overflow: hidden;
        }
        .pub-card:hover {
            background: rgba(0, 0, 0, 0.92);
            /*box-shadow: 0 4px 28px rgba(0,0,0,0.75);*/
        }
        .pub-title {
            color: #ffffff;
            font-size:1.05rem;
            margin:0;
        }
        .pub-authors {
            font-style:italic;
            color:#cccccc;
            margin:0.25rem 0 0;
        }
        .pub-venue {
            font-weight:600;
            color:#00c3ff;
        }
        .pub-year {
            position:absolute;
            right:20px;
            top:1rem;
            color:#00c3ff;
            font-weight:bold;
        }
        .pub-links {
            margin-top:0.5rem;
        }
        .pub-links a {
            color:#00c3ff;
            margin-right:0.75rem;
            text-decoration:none;
        }
        .pub-abstract {
            margin-top:0.75rem;
            font-size:0.95rem;
            line-height:1.5rem;
            color:#d0d0d0;
        }
        .pub-card.expanded .pub-abstract {
            display:block;
        }

        /* Search Bar */
        .toolbar {
            display: flex;
            justify-content: center;   /* centers toolbar in page */
            align-items: center;       /* vertically align button + input */
            margin: 1.2rem 0 0.8rem 0;
            gap: 0;                    /* remove spacing between input and button */
        }

        .search-box {
            padding: 14px 22px;
            font-size: 17px;
            border: 2px solid black;
            border-radius: 35px 0 0 35px; /* left pill corners rounded, right square */
            outline: none;
            width: 550px;              /* keeps original size */
        }
        .search-btn {
            padding: 14px 28px;
            font-size: 17px;
            background: #0d6efd;
            color: white;
            border: 2px solid black;
            border-left: none;         /* merge with search bar */
            border-radius: 0 35px 35px 0; /* right pill corners rounded, left square */
            cursor: pointer;
            font-weight: 600;
            width: auto;
            flex-shrink: 0;
        }

        .search-btn:hover {
            background: #0b5ed7;
        }

        .search-btn:hover {
            background: #0b5ed7;
        }


        #updateBtn {
            padding: 14px 28px;
            font-size: 17px;
            background: #28a745;
            color: white;
            border: 2px solid black;
            border-radius: 35px;   /* fully rounded */
            cursor: pointer;
            font-weight: 600;
            margin-left: 8px;
        }
        #updateBtn:hover {
            background: #218838;   /* slightly darker green on hover */
        }

        #deleteBtn {
            padding: 14px 28px;
            font-size: 17px;
            background: #dc3545;
            color: white;
            border: 2px solid black;
            border-radius: 35px;   /* fully rounded */
            cursor: pointer;
            font-weight: 600;
            margin-left: 8px;
        }
        #deleteBtn:hover {
            background: #c82333;   /* slightly darker red on hover */
        }


        /* Filters */
        .filter-container {
            display: flex;
            justify-content: center;
            gap: 8px;                    /* SMALLER GAP */
            margin-bottom: 1.6rem;
        }

        .filter-select {
            padding: 8px 14px;
            font-size: 15px;
            border: 2px solid black;
            border-radius: 10px;
            background: white;
        }

        #consoleOutput {
            background: #000 !important;
            color: #00ff00;
            font-family: "Roboto Mono", monospace;
            font-size: 0.95rem;

            width: 95%;
            margin: 1rem auto 1.2rem auto;
            padding: 14px;

            border-radius: 8px;
            border: none !important;

            min-height: 150px;          /* NEW: minimum console height */
            max-height: 350px;          /* optional: console scrolls beyond this */
            overflow-y: auto;

            box-shadow: none !important;
        }

        #consoleOutput,
        #consoleOutput * {
            background: #000 !important;
            border: none !important;
            box-shadow: none !important;
        }

        /* Card Grid — 4 cards per row */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr); /* 4 columns */
            gap: 20px; /* space between cards */
            padding: 0;
            align-items: stretch; /* all cards same height */
        }

        /* Cards */
        .card {
            background: #fff;
            border: 2px solid black;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            height: auto; /* auto height based on content */
        }

        /* Card Body */
        .card-body {
            padding: 12px;
            flex: 1; /* take remaining space */
            overflow: auto; /* scroll if content overflows */
        }

        /* Card Title & Text */
        .card-title {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 8px;
            word-wrap: break-word;
            overflow-wrap: anywhere;
        }

        .card-text {
            font-size: 13px;
            line-height: 1.5;
            word-wrap: break-word;
            overflow-wrap: anywhere;
        }

        /* Responsive — 2 cards per row on tablets, 1 on mobile */
        @media(max-width:1024px) {
            .card-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media(max-width:768px) {
            .card-grid {
                grid-template-columns: 1fr;
            }
        }


        #wikitext {
            margin-top:5px;
            line-height:1.33em;
            font-family: 'Merriweather', serif;
            color: #000000;
            font-size: 1rem;
        }
    </style>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">
<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://imashrivastava.github.io/dbms">Animal Welfare Platform</a>
        </div>

        <div class="collapse navbar-collapse">
            <ul class="nav navbar-nav navbar-right">
                <li class="nav-item"><a href="https://imashrivastava.github.io/animals" data-target="#about"><span>Animals</span></a></li>
                <li class="nav-item"><a href="https://imashrivastava.github.io/stations"><span>Stations</span></a></li>
                <li class="nav-item"><a href="https://imashrivastava.github.io/team"><span>Team</span></a></li>
                <li class="nav-item"><a href="https://imashrivastava.github.io/doctors"><span>Doctors</span></a></li>
                <li class="nav-item"><a href="https://imashrivastava.github.io/daq"><span>DAQ</span></a></li>
            </ul>
        </div>
    </div>
</nav>

<div class="container">

    <div class="toolbar">
        <input type="text" id="searchInput" placeholder="Search Staff ID" class="search-box">
        <button id="searchBtn" class="search-btn">Search</button>
        <button id="updateBtn" class="search-btn" style="background:#28a745;">Update</button>
        <button id="deleteBtn" class="search-btn" style="background:#dc3545;">Delete</button>
    </div>

    <div class="filter-container">
        <select id="filterCity" class="filter-select">
            <option value="">City (All)</option>
            <option value="Delhi">Delhi</option>
            <option value="Mumbai">Mumbai</option>
            <option value="Pune">Pune</option>
            <option value="Bangalore">Bangalore</option>
            <option value="Chennai">Chennai</option>
        </select>

        <select id="filterState" class="filter-select">
            <option value="">State (All)</option>
            <option value="Delhi">Delhi</option>
            <option value="Maharashtra">Maharashtra</option>
            <option value="Karnataka">Karnataka</option>
            <option value="Tamil Nadu">Tamil Nadu</option>
        </select>

        <select id="filterRole" class="filter-select">
            <option value="">Role (All)</option>
            <option value="A">Admin</option>
            <option value="V">Volunteer</option>
            <option value="M">Manager</option>
        </select>
    </div>

    <div id="popupForm" style="display:none; position:fixed; top:10%; left:50%; transform:translateX(-50%); background:white; padding:20px; border:2px solid black; border-radius:10px; z-index:1000;">
        <h3>Update Staff Info</h3>
        <label>First Name: <input type="text" id="formFName"></label><br>
        <label>Last Name: <input type="text" id="formLName"></label><br>
        <label>Role:
            <select id="formRole">
                <option value="A">Admin</option>
                <option value="V">Volunteer</option>
                <option value="M">Manager</option>
            </select>
        </label><br>
        <label>Hourly Wage: <input type="number" id="formWage" step="0.01"></label><br>
        <label>Address: <input type="text" id="formAddress"></label><br>
        <label>City: <input type="text" id="formCity"></label><br>
        <label>State: <input type="text" id="formState"></label><br>
        <label>Pincode: <input type="text" id="formPincode"></label><br>
        <button id="saveBtn">Save</button>
        <button id="closeBtn">Close</button>
    </div>

    <div id="consoleOutput"></div>

    <div id="cardGrid" class="card-grid">
    </div>

</div>



<footer class="site-footer">
    <div class="container">
        <p class="powered-by">
            &copy;  <script>document.write(new Date().getFullYear());</script> Aman Shrivastava
            <span class="pull-right" aria-hidden="true">
           <a href="#" id="back_to_top">
             <span class="button_icon">
               <i class="fa fa-chevron-up fa-2x"></i>
             </span>
           </a>
         </span>
        </p>
    </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha512-jGsMH83oKe9asCpkOVkBnUrDDTp8wl+adkB2D+//JtlxO4SrLoJdhbOysIFQJloQFD+C4Fl1rMsQZF76JjV0eQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.2/imagesloaded.pkgd.min.js" integrity="sha512-iHzEu7GbSc705hE2skyH6/AlTpOfBmkx7nUqTLGzPYR+C1tRaItbRlJ7hT/D3YQ9SV0fqLKzp4XY9wKulTBGTw==" crossorigin="anonymous"></script>

<script>
    $(document).ready(function() {
        const BASE_URL = "https://cpscdbms-f50436d7d43e.herokuapp.com/api";
        const cardGrid = $("#cardGrid");
        const consoleOutput = $("#consoleOutput");

        function logToConsole(msg) {
            const c = document.getElementById("consoleOutput");
            c.innerHTML += msg + "<br>";
            c.scrollTop = c.scrollHeight;
        }

        function loadDivisionQuery() {
            const url = `${BASE_URL}/staff/all-maintainers`;
            logToConsole(`> FETCH (DIVISION): ${url}`);

            $.getJSON(url)
                .done(function(data) {
                    if (!data || data.length === 0) {
                        logToConsole("> DIVISION RESULT: No staff found who maintain ALL stations.");
                        return;
                    }

                    const names = data.map(staff => `${staff.F_name} ${staff.L_name} (${staff.staffID})`);
                    logToConsole(`> DIVISION RESULT: Found ${data.length} staff member(s) who maintain ALL stations:`);
                    names.forEach(name => logToConsole(`> \t- ${name}`));
                })
                .fail(err => {
                    const errorMsg = err.responseText ? JSON.parse(err.responseText).error : err.statusText;
                    logToConsole(`!! ERROR running Division Query: ${errorMsg || "Unknown error"}`);
                });
        }

        function fetchStaff(searchTerm = "") {

            const filterCity = $("#filterCity").val();
            const filterState = $("#filterState").val();
            const filterRole = $("#filterRole").val();

            let queryParams = `search=${encodeURIComponent(searchTerm)}`;

            if (filterCity) {
                queryParams += `&city=${encodeURIComponent(filterCity)}`;
            }
            if (filterState) {
                queryParams += `&state=${encodeURIComponent(filterState)}`;
            }
            if (filterRole) {
                queryParams += `&role=${encodeURIComponent(filterRole)}`;
            }

            const url = `${BASE_URL}/staff?${queryParams}`;

            logToConsole(`> FETCH: ${url}`);

            $.getJSON(url)
                .done(function(data) {
                    cardGrid.empty();
                    if (!data || data.length === 0) {
                        logToConsole("> LOADED: No staff found matching criteria.");
                        loadDivisionQuery();
                        return;
                    }

                    logToConsole(`> LOADED: ${data.length} staff records found.`);

                    data.forEach(staff => {
                        let stationsDisplay = staff.stations.join(", ");
                        let reportsToDisplay = staff.reports_to || "N/A";

                        // Admin/None Display Logic
                        if (staff.role === 'A') {
                            stationsDisplay = "None";
                            reportsToDisplay = "None";
                        } else if (staff.stations.length === 0) {
                            stationsDisplay = "None";
                        }

                        const card = $(`
                    <div class="card">
                        <div class="card-body">
                            <div class="card-title">${staff.F_name} ${staff.L_name} (${staff.role})</div>
                            <div class="card-text">
                                Staff ID: ${staff.staffID}<br>
                                Hourly Wage: ${staff.hourlyWage}<br>
                                Address: ${staff.address}, ${staff.city}, ${staff.state} - ${staff.pincode}<br>
                                Stations: ${stationsDisplay}<br>
                                Reports to: ${reportsToDisplay}
                            </div>
                        </div>
                    </div>
                `);
                        cardGrid.append(card);
                    });
                    logToConsole(`> DISPLAY: Showing ${data.length} staff records`);

                    loadDivisionQuery();
                })
                .fail(err => {
                    logToConsole("!! ERROR fetching staff: " + (err.responseText || err.statusText));
                    loadDivisionQuery();
                });
        }

        $("#filterCity, #filterState, #filterRole").on('change', function() {
            $("#searchInput").val('');
            logToConsole(`> FETCH the FILTERED list of Staff.`);
            fetchStaff();
        });

        $("#searchBtn").click(() => {
            const searchTerm = $("#searchInput").val().trim();
            $("#filterCity").val('');
            $("#filterState").val('');
            $("#filterRole").val('');

            logToConsole(`> SEARCH triggered for Staff ID: "${searchTerm}"`);
            fetchStaff(searchTerm);
        });

        $("#updateBtn").click(() => {
            const staffID = $("#searchInput").val().trim();
            if (!staffID) return alert("Enter Staff ID to update");

            logToConsole(`> FETCH for UPDATE: Staff ID ${staffID}`);

            $.getJSON(`${BASE_URL}/staff?search=${encodeURIComponent(staffID)}`)
                .done(function(data) {
                    if (!data || data.length === 0) {
                        logToConsole(`!! ERROR: Staff ID ${staffID} not found for update.`);
                        alert("Staff not found.");
                        return;
                    }
                    const staff = data[0];
                    logToConsole(`> LOADED: Info for ${staffID}. Opening form.`);

                    $("#formFName").val(staff.F_name);
                    $("#formLName").val(staff.L_name);
                    $("#formRole").val(staff.role);
                    $("#formWage").val(staff.hourlyWage);
                    $("#formAddress").val(staff.address);
                    $("#formCity").val(staff.city);
                    $("#formState").val(staff.state);
                    $("#formPincode").val(staff.pincode);
                    $("#popupForm").data("staffID", staffID).show();
                })
                .fail(err => logToConsole("!! ERROR fetching staff for update: " + (err.responseText || err.statusText)));
        });

        $("#closeBtn").click(() => {
            logToConsole("> UPDATE: Form closed.");
            $("#popupForm").hide();
        });

        $("#saveBtn").click(() => {
            const staffID = $("#popupForm").data("staffID");
            const payload = {
                staffID: staffID,
                F_name: $("#formFName").val(),
                L_name: $("#formLName").val(),
                role: $("#formRole").val(),
                hourlyWage: $("#formWage").val(),
                address: $("#formAddress").val(),
                city: $("#formCity").val(),
                state: $("#formState").val(),
                pincode: $("#formPincode").val()
            };

            logToConsole(`> POST: Updating staff ${staffID}...`);

            $.ajax({
                url: `${BASE_URL}/staff/update`,
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify(payload),
                success: function() {
                    logToConsole(`> SUCCESS: Updated staff ${staffID} successfully.`);
                    $("#popupForm").hide();
                    fetchStaff(staffID);
                },
                error: function(err) {
                    logToConsole(`!! ERROR updating staff ${staffID}: ${err.responseText || err.statusText}`);
                }
            });
        });

        $("#deleteBtn").click(() => {
            const staffID = $("#searchInput").val().trim();
            if (!staffID) return alert("Enter Staff ID to delete");
            if (!confirm(`Delete staff ${staffID}? This will cascade delete associated data.`)) return;

            logToConsole(`> POST: Attempting to delete staff ${staffID}...`);

            $.ajax({
                url: `${BASE_URL}/staff/delete`,
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify({ staffID: staffID }),
                success: function() {
                    logToConsole(`> SUCCESS: Deleted staff ${staffID} successfully.`);
                    fetchStaff(); // Reload all staff after deletion
                },
                error: function(err) {
                    logToConsole(`!! ERROR deleting staff ${staffID}: ${err.responseText || err.statusText}`);
                }
            });
        });

        logToConsole("> INITIALIZING: Starting data load.");
        fetchStaff();
    });
</script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.2/imagesloaded.pkgd.min.js" integrity="sha512-iHzEu7GbSc705hE2skyH6/AlTpOfBmkx7nUqTLGzPYR+C1tRaItbRlJ7hT/D3YQ9SV0fqLKzp4XY9wKulTBGTw==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/TweenMax.min.js" integrity="sha512-Z5heTz36xTemt1TbtbfXtTq5lMfYnOkXM2/eWcTTiLU01+Sw4ku1i7vScDc8fWhrP2abz9GQzgKH5NGBLoYlAw==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/plugins/ScrollToPlugin.min.js" integrity="sha512-CDeU7pRtkPX6XJtF/gcFWlEwyaX7mcAp5sO3VIu/ylsdR74wEw4wmBpD5yYTrmMAiAboi9thyBUr1vXRPA7t0Q==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>
<script src="/js/hugo-academic.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>
